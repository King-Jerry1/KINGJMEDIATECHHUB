<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Forgot Password - King J Media</title>

<!-- Bootstrap 5 -->
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
<!-- SweetAlert2 -->
<script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
<!-- Bootstrap Icons -->
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons/font/bootstrap-icons.css">

<style>
body { background-color: #f0f2f5; }

.form-card {
  background-color: #ffffff;
  padding: 2rem;
  border-radius: 12px;
  box-shadow: 0 6px 20px rgba(0,0,0,0.1);
  max-width: 450px;
  margin: 2rem auto;
  text-align: center;
}

.step { display: none; }
.step.active { display: block; }

.verification-digit {
  width: 50px; height: 50px;
  font-size: 1.5rem;
  text-align: center;
  border-radius: 8px;
  border: 1px solid #ced4da;
}

.progress-steps {
  display: flex; justify-content: center; gap: 15px; margin-bottom: 2rem;
}

.progress-steps .circle {
  width: 30px; height: 30px; border-radius: 50%;
  background-color: #ced4da; display: flex;
  justify-content: center; align-items: center;
  color: white; font-weight: bold; cursor: pointer;
}

.progress-steps .circle.active { background-color: #0d6efd; }
.progress-steps .circle.completed { background-color: #ff0090; }

.toggle-container { display: flex; justify-content: center; margin-bottom: 1.5rem; }
.toggle-switch {
  position: relative;
  width: 220px;
  height: 50px;
  background-color: #e0e0e0;
  border-radius: 25px;
  cursor: pointer;
  user-select: none;
  display: flex;
  align-items: center;
  font-weight: bold;
  color: #555;
}
.toggle-slider {
  position: absolute;
  width: 110px;  /* Half of container */
  height: 44px;
  background-color: #0d6efd;
  border-radius: 22px;
  top: 3px;
  left: 3px;
  transition: all 0.3s ease;
  z-index: 1;
}
.toggle-left, .toggle-right {
  flex: 1;
  text-align: center;
  z-index: 2;
  transition: color 0.3s;
}
.toggle-left.active, .toggle-right.active { color: #fff; }
</style>
</head>
<body>

<div class="container py-5">

  <!-- Step Progress -->
  <div class="progress-steps">
    <div class="circle active" id="circle-1">1</div>
    <div class="circle" id="circle-2">2</div>
    <div class="circle" id="circle-3">3</div>
    <div class="circle" id="circle-4">4</div>
  </div>

  <!-- Step 1: Email / Phone -->
  <div class="step step-1 active form-card">
    <div class="toggle-container">
      <div class="toggle-switch" id="toggleSwitch" onclick="switchInputToggle()">
        <div class="toggle-slider" id="toggleSlider"></div>
        <span class="toggle-left active">Use Email</span>
        <span class="toggle-right">Use Phone</span>
      </div>
    </div>
    <input type="email" id="forget-email" class="form-control mb-3" placeholder="Enter your email">
    <input type="tel" id="forget-phone" class="form-control mb-3 d-none" placeholder="Enter your phone number">
    <button class="btn btn-primary w-100" onclick="sendVerificationCode()">Send Verification Code</button>
  </div>

  <!-- Step 2: Verification Code -->
  <div class="step step-2 form-card">
    <h3 class="mb-3">Enter Verification Code</h3>
    <p>We sent a 4-digit code to your email/phone</p>
    <div class="d-flex justify-content-center gap-2 mb-3">
      <input type="text" maxlength="1" class="form-control verification-digit" oninput="moveNext(this,event)">
      <input type="text" maxlength="1" class="form-control verification-digit" oninput="moveNext(this,event)">
      <input type="text" maxlength="1" class="form-control verification-digit" oninput="moveNext(this,event)">
      <input type="text" maxlength="1" class="form-control verification-digit" oninput="moveNext(this,event)">
    </div>
    <button class="btn btn-success w-100" onclick="verifyCode()">Verify Code</button>
  </div>

  <!-- Step 3: Success -->
  <div class="step step-3 form-card">
    <h3 class="mb-4">Verified!</h3>
    <p>Your email/phone has been successfully verified. You can now reset your password.</p>
    <button class="btn btn-primary w-100" onclick="nextStep(3)">Proceed</button>
  </div>

  <!-- Step 4: Reset Password -->
  <div class="step step-4 form-card">
    <h3 class="mb-4">Reset Password</h3>
    <input type="password" id="password" class="form-control mb-3" placeholder="New Password">
    <input type="password" id="confirm-password" class="form-control mb-3" placeholder="Confirm Password">
    <button class="btn btn-primary w-100" onclick="resetPassword()">Submit</button>
  </div>

</div>

<script>
let toggleState = 'email'; // default

function updateProgress(step){
  for(let i=1;i<=4;i++){
    const circle=document.getElementById(`circle-${i}`);
    circle.classList.remove('active','completed');
    if(i<step){
      circle.classList.add('completed');
      circle.innerHTML = '<i class="bi bi-check"></i>';
    } else {
      circle.innerHTML = i;
    }
    if(i===step){
      circle.classList.add('active');
      circle.innerHTML = i;
    }
  }
}

function nextStep(step){
  const current=document.querySelector(`.step-${step}`);
  const next=document.querySelector(`.step-${step+1}`);
  if(current && next){
    current.classList.remove('active');
    next.classList.add('active');
    updateProgress(step+1);
  }
}

function moveNext(input,event){
  if(input.value.length>=1){
    const next=input.nextElementSibling;
    if(next && next.classList.contains('verification-digit')) next.focus();
  }
  if(event.inputType==='deleteContentBackward'){
    const prev=input.previousElementSibling;
    if(prev && prev.classList.contains('verification-digit')) prev.focus();
  }
}

function switchInputToggle(){
  const slider = document.getElementById('toggleSlider');
  const emailInput = document.getElementById('forget-email');
  const phoneInput = document.getElementById('forget-phone');
  const left = document.querySelector('.toggle-left');
  const right = document.querySelector('.toggle-right');

  if(toggleState==='email'){
    slider.style.left = 'calc(50% + 3px)';
    toggleState='phone';
    emailInput.classList.add('d-none');
    phoneInput.classList.remove('d-none');
    phoneInput.focus();
    left.classList.remove('active');
    right.classList.add('active');
  } else {
    slider.style.left = '3px';
    toggleState='email';
    emailInput.classList.remove('d-none');
    phoneInput.classList.add('d-none');
    emailInput.focus();
    left.classList.add('active');
    right.classList.remove('active');
  }
}

function sendVerificationCode(){
  let value;
  if(toggleState==='email'){
    value = document.getElementById('forget-email').value;
    if(!value || !/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(value)){
      Swal.fire('Oops','Please enter a valid email!','warning');
      return;
    }
  } else {
    value = document.getElementById('forget-phone').value;
    if(!value || !/^\d{10}$/.test(value)){
      Swal.fire('Oops','Please enter a valid 10-digit phone number!','warning');
      return;
    }
  }

  Swal.fire({
    title:'Sending Verification Code...',
    text: `to ${value}`,
    timer:1500,
    showConfirmButton:false,
    icon:'info'
  }).then(()=> nextStep(1));
}

function verifyCode(){
  const codeInputs=document.querySelectorAll('.verification-digit');
  let code='';
  codeInputs.forEach(i=> code+=i.value);
  if(code.length!==4){
    Swal.fire('Incomplete','Please enter the 4-digit code','warning');
    return;
  }

  Swal.fire({title:'Verifying Code...', timer:1500, showConfirmButton:false, icon:'success'})
  .then(()=> nextStep(2));
}

function resetPassword(){
  const pwd=document.getElementById('password').value;
  const confirmPwd=document.getElementById('confirm-password').value;

  if(pwd.length<6 || pwd!==confirmPwd){
    Swal.fire('Error','Passwords must match and be at least 6 characters','error');
    return;
  }

  Swal.fire({
    title:'Password Reset!',
    text:'Your password has been updated successfully.',
    icon:'success',
    timer:2000,
    showConfirmButton:false
  }).then(()=> window.location.href='login.html');

  updateProgress(4);
}
</script>

</body>
</html>
